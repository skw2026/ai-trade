# AI交易机器人

> **核心目标**：构建一套面向 BTC/ETH/SOL 永续合约的 C++ 高频/中频交易系统。
>
> **设计哲学**：生存优先 > 风险可控 > 可验证正期望。不承诺“稳定收益”，但强调“可回滚、可审计、硬风控”。

---

## 需求符合性核对表

| 用户核心要求                 | 文档落点                              | 覆盖情况  |
| ---------------------- | --------------------------------- | ----- |
| 标的：BTC/ETH/SOL（主流币）    | 首页项目目标、PRD范围、默认参数                 | ✅ 已覆盖 |
| 交易品类：永续合约              | 项目目标、PRD范围、模块设计（合约规则/资金费率/标记价）    | ✅ 已覆盖 |
| 风险可控、避免爆仓/清零           | 风控硬规则：逐仓、杠杆白名单、强平距离阈值、回撤三阈值、断连只减仓 | ✅ 已覆盖 |
| 最大回撤目标：20%（中等风险）       | PRD KRI、默认参数附录、风控设计               | ✅ 已覆盖 |
| 不承诺稳定收益，但强调可验证正期望      | 项目目标、KPI/KRI                      | ✅ 已覆盖 |
| 自进化（可控范围：策略权重/参数/状态识别） | 产品目标、KRI自进化验收、SDD Bandit/Regime   | ✅ 已覆盖 |
| 闸门与回滚（回测→纸交易→小实盘、自动回滚） | PRD 1.3.5/1.5、SDD 3.10、工程验收用例     | ✅ 已覆盖 |
| 语言偏好：C++               | SDD 技术栈、线程模型、Repo结构               | ✅ 已覆盖 |
| 可落地可验收（含工程验收）          | PRD KPI/KRI + 工程验收 + 指标规范 + 用例模板  | ✅ 已覆盖 |

---

## 📚 文档导航

### 1. 核心设计
- **[需求与验收标准 (PRD)](docs/需求描述.md)**: 详细的项目目标、KRI/KPI 指标及验收标准。
- **[系统架构 (Architecture)](docs/架构设计.md)**: 模块划分、数据流向、故障模式与线程模型。
- **[数据与事件规范 (Specs)](docs/规范约束.md)**: 核心事件字段定义、幂等性设计与 C++ 结构参考。

### 2. 策略与风控
- **[交易策略 (Strategy)](docs/交易策略.md)**: Trend/MeanRev/VolTarget 策略逻辑、Regime 识别与 Bandit 自进化。
- **[风险控制与执行 (Risk & Execution)](docs/风险控制.md)**: **(核心)** 硬风控状态机、熔断机制、OMS 逻辑与 Gate 流程。

### 3. 工程落地
- **[开发指南 (Developer)](docs/开发指南.md)**: 环境搭建、编译构建、模拟器运行指南。
- **[配置手册 (Configuration)](docs/配置手册.md)**: 系统配置模板、风控参数硬约束说明。

---

## 🛡️ 关键工程原则 (Must Follow)

### 硬边界（不可学习、不可越权）
- 逐仓强制（Isolated only）
- 杠杆白名单：BTC/ETH ≤ 3x；SOL ≤ 2x；event_window/EXTREME → 1x
- 回撤三阈值（账户级）：8%降档 / 12%强减仓+冷却 / 20%熔断全平+冷却+分段恢复
- 强平距离（加权P95）：<8% 强制减仓；目标恢复≥10%

### 自进化范围（可控）
- 允许进化：策略权重、白名单参数、Regime版本（规则/模型）
- 不允许进化：硬风控阈值与硬规则
- 所有进化必须走 Gate：回放回归 → 模拟盘撮合回归 → Shadow →（可选）小实盘

## 🚀 快速开始

请参考 [docs/开发指南.md](docs/开发指南.md) 进行环境配置与构建。

### 项目结构概览
```text
ai-trade/
├── bin/                 # 编译产出
├── config/              # 配置文件 (yaml)
├── data/                # 本地回测数据/缓存
├── docs/                # 项目文档
├── src/
│   ├── core/            # 核心库 (Log, Config, EventBus, Utils)
│   ├── market/          # 行情适配 (Exchange Adapter)
│   ├── strategy/        # 策略逻辑 (Trend, VolTarget)
│   ├── risk/            # 风控引擎 (RiskEngine)
│   └── execution/       # 执行与OMS (OrderManager)
├── tests/               # 单元测试 (GTest)
└── tools/               # 模拟器、回放工具
```

## 📅 最小落地路径
1) 先做“可观测骨架”：配置/日志/指标/审计事件落地
2) 打通交易闭环：交易所适配 → OMS → 风控 → 执行（先支持 BTC/ETH）
3) 上线最小策略闭环：Feature → Trend + VolTarget → Portfolio → Risk → Execution
